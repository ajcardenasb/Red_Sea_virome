pw.alpha
merge(dna, rna)
View(rna)
pairwise.t.test(all.alpha$chao,all.alpha$groups, p.adj = "fdr")
View(all.alpha)
t.test(subset(all.alpha, rownames(all.alpha) %like% "POC")$chao ~all.alpha$groups)
subset(all.alpha, rownames(all.alpha) %like% "POC")$chao
subset(all.alpha, rownames(all.alpha) %like% "POC")
subset(all.alpha, rownames(all.alpha) %like% "POC")[,2]
t.test(subset(all.alpha, rownames(all.alpha) %like% "POC")$chao ~all.alpha$groups)
all.alpha$groups
t.test(subset(all.alpha, rownames(all.alpha) %like% "POC")$chao ~ subset(all.alpha, rownames(all.alpha) %like% "POC")$groups)
t.test(subset(all.alpha, rownames(all.alpha) %like% "POR")$chao ~ subset(all.alpha, rownames(all.alpha) %like% "POR")$groups)
t.test(subset(all.alpha, rownames(all.alpha) %like% "STY")$chao ~ subset(all.alpha, rownames(all.alpha) %like% "STY")$groups)
t.test(subset(all.alpha, rownames(all.alpha) %like% "PAC")$chao ~ subset(all.alpha, rownames(all.alpha) %like% "PAC")$groups)
shapiro.test(all.alpha$chao)
library(vegan)
library(pairwiseAdonis)
library(reshape2)
library(phyloseq)
library(microbiome)
library(tidyr)
library(gridExtra)
setwd("~/Documents/GitHub/Red_Sea_virome/")
#data in
dna=read.table("./Input_files/MG_filtered_counts", header = TRUE, row.names = 1)
rna=read.table("./Input_files/MT_filtered_counts", header = TRUE, row.names = 1)
met=read.table("./Input_files/redSea_virome_metadata", header = TRUE, row.names = 1, fill = TRUE)
# cretae phyloseq objects
otu.dna= otu_table(dna, taxa_are_rows=TRUE)
sam.dna= sample_data(met)
phy.dna= phyloseq(otu.dna, sam.dna)
otu.rna= otu_table(rna, taxa_are_rows=TRUE)
sam.rna= sample_data(met)
phy.rna= phyloseq(otu.rna, sam.rna)
####Transforming counts
dna.t=microbiome::transform(phy.dna, transform = "log10p", target = "OTU", shift = 0, scale = 1)
rna.t=microbiome::transform(phy.rna, transform = "log10p", target = "OTU", shift = 0, scale = 1)
####Ordination plots
COLdna=c("#8DD3C7", "#FFFFB3", "#9fb9bf","#FB8072","#80B1D3","#FDB462","#B3DE69", "#CCEBC5","#D9D9D9","#BC80BD","#FCCDE5","#BEBADA","#b88c8c")
COLrna=c("#919191", "#FFFFB3", "#FB8072","#FDB462","#B3DE69", "#BC80BD", "#FCCDE5","#BEBADA" ) ##FFED6F
dna.ord=ordinate(dna.t, "PCoA", "bray", ~Species)
plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_colour_manual(values=COLdna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 0.5) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_colour_manual(values=COLdna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_colour_manual(values=COLdna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
rna.ord=ordinate(rna.t, "PCoA", "bray", ~Species)
plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank()) + scale_colour_manual(values=COLrna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_colour_manual(values=COLdna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank()) + scale_colour_manual(values=COLrna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
grid.arrange(a,b, ncol=2, nrow=1)
COLrna=c("#FFED6F", "#FFFFB3", "#FB8072","#FDB462","#B3DE69", "#BC80BD", "#FCCDE5","#BEBADA" ) ##FFED6F
grid.arrange(a,b, ncol=2, nrow=1)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_colour_manual(values=COLdna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank()) + scale_colour_manual(values=COLrna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
grid.arrange(a,b, ncol=2, nrow=1)
####Ordination plots
COLdna=c("#8DD3C7", "#518C4B", "#9fb9bf","#FB8072","#80B1D3","#FDB462","#B3DE69", "#CCEBC5","#D9D9D9","#BC80BD","#FCCDE5","#BEBADA","#b88c8c")
COLrna=c("#FFED6F", "#518C4B", "#FB8072","#FDB462","#B3DE69", "#BC80BD", "#FCCDE5","#BEBADA" ) ##FFED6F
dna.ord=ordinate(dna.t, "PCoA", "bray", ~Species)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_colour_manual(values=COLdna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
rna.ord=ordinate(rna.t, "PCoA", "bray", ~Species)
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank()) + scale_colour_manual(values=COLrna) + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 ))
grid.arrange(a,b, ncol=2, nrow=1)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #
rna.ord=ordinate(rna.t, "PCoA", "bray", ~Species)
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #+ scale_colour_manual(values=COLrna)
grid.arrange(a,b, ncol=2, nrow=1)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Life_history_strategy")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Life_history_strategy")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #+ scale_colour_manual(values=COLrna)
grid.arrange(a,b, ncol=2, nrow=1)
dna.ord=ordinate(dna.t, "CAP", "bray", ~Species)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Life_history_strategy")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #
rna.ord=ordinate(rna.t, "CAP", "bray", ~Species)
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Life_history_strategy")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #+ scale_colour_manual(values=COLrna)
grid.arrange(a,b, ncol=2, nrow=1)
?ordinate
dna.ord=ordinate(dna.t, "CCA", "bray", ~Species)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Life_history_strategy")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #
rna.ord=ordinate(rna.t, "CCA", "bray", ~Species)
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Life_history_strategy")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #+ scale_colour_manual(values=COLrna)
grid.arrange(a,b, ncol=2, nrow=1)
dna.ord=ordinate(dna.t, "PCoA", "bray", ~Species)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #
rna.ord=ordinate(rna.t, "PCoA", "bray", ~Species)
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) #+ scale_colour_manual(values=COLrna)
grid.arrange(a,b, ncol=2, nrow=1)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) + scale_colour_manual(values=COLdna)
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())  + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) + scale_colour_manual(values=COLrna)
grid.arrange(a,b, ncol=2, nrow=1)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank(), legend.position="none")   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) + scale_colour_manual(values=COLdna)
dna.ord=ordinate(dna.t, "PCoA", "bray", ~Species)
a=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank(), legend.position="none")   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) + scale_colour_manual(values=COLdna)
rna.ord=ordinate(rna.t, "PCoA", "bray", ~Species)
b=plot_ordination(rna.t,rna.ord ,  color = "Species", shape = "Minor_Clade")  + geom_point(size = 3, alpha = 1) + theme_bw()  + ggtitle("Metatranscriptomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank(),  legend.position="none")  + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) + scale_colour_manual(values=COLrna)
names.bar=plot_ordination(dna.t,dna.ord , color = "Species", shape = "Minor_Clade")  + geom_point(size = 3) + theme_bw()  + ggtitle("Metagenomes") + theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())   + scale_shape_manual(values=c(0,1,2,3,4,5,6,7,8,9,10,11 )) + scale_colour_manual(values=COLdna)
leg.bar=get_legend(names.bar)
grid.arrange(a,b, leg.bar, ncol=2, nrow=1, n col =2)
grid.arrange(a,b, leg.bar, ncol=2, nrow=1, ncol =2)
grid.arrange(a,b, leg.bar, ncol=2, nrow=2)
pdf("./outputs/RedSeaVirome_ordination.pdf",  width = 12, height = 5, pointsize = 12)
grid.arrange(a,b, leg.bar, ncol=3, nrow=1)
dev.off()
grid.arrange(a,b, leg.bar, ncol=3, nrow=1)
pdf("./outputs/RedSeaVirome_ordination.pdf",  width = 12, height = 5, pointsize = 12)
grid.arrange(a,b, leg.bar, ncol=3, nrow=1)
dev.off()
?ordinate
setwd("~/Documents/GitHub/Red_Sea_virome/Input_files/")
dna=read.table("MG_filtered_counts", header = TRUE)
clr.dna=as.data.frame(NormalizeData((dna), normalization.method = "CLR"))
colnames(clr.dna)=gsub("MG_", "", colnames(clr.dna))
colnames(clr.dna)=gsub("[0-9]", "", colnames(clr.dna))
dna.mean= as.data.frame(sapply(unique(names(clr.dna)), function(col) rowMeans(clr.dna[names(clr.dna) == col])))
dna.dist= vegdist(t(dna.mean), method  = "bray")
dna.hclu = as.dendrogram(hclust(dna.dist, method = "ward.D"))
dna=read.table("MG_filtered_counts", header = TRUE)
clr.dna=as.data.frame(NormalizeData((dna), normalization.method = "CLR"))
colnames(clr.dna)=gsub("MG_", "", colnames(clr.dna))
colnames(clr.dna)=gsub("[0-9]", "", colnames(clr.dna))
dna.mean= as.data.frame(sapply(unique(names(clr.dna)), function(col) rowMeans(clr.dna[names(clr.dna) == col])))
dna.dist= vegdist(t(dna.mean), method  = "bray")
rna=read.table("MT_filtered_counts", header = TRUE)
clr.rna=as.data.frame(NormalizeData((rna), normalization.method = "CLR"))
colnames(clr.rna)=gsub("MT_", "", colnames(clr.rna))
colnames(clr.rna)=gsub("[0-9]", "", colnames(clr.rna))
rna.mean= as.data.frame(sapply(unique(names(clr.rna)), function(col) rowMeans(clr.rna[names(clr.rna) == col])))
rna.dist= vegdist(t(rna.mean), method  = "bray")
install.packages(IntClust)
dna.dist
dna=read.table("MG_filtered_counts", header = TRUE)
library(vegan)
library(pairwiseAdonis)
library(reshape2)
library(phyloseq)
library(microbiome)
library(tidyr)
library(gridExtra)
setwd("~/Documents/GitHub/Red_Sea_virome/")
#data in
dna=read.table("./Input_files/MG_filtered_counts", header = TRUE, row.names = 1)
rna=read.table("./Input_files/MT_filtered_counts", header = TRUE, row.names = 1)
met=read.table("./Input_files/redSea_virome_metadata", header = TRUE, row.names = 1, fill = TRUE)
# cretae phyloseq objects
otu.dna= otu_table(dna, taxa_are_rows=TRUE)
sam.dna= sample_data(met)
phy.dna= phyloseq(otu.dna, sam.dna)
otu.rna= otu_table(rna, taxa_are_rows=TRUE)
sam.rna= sample_data(met)
phy.rna= phyloseq(otu.rna, sam.rna)
####Transforming counts
dna.t=microbiome::transform(phy.dna, transform = "log10p", target = "OTU", shift = 0, scale = 1)
rna.t=microbiome::transform(phy.rna, transform = "log10p", target = "OTU", shift = 0, scale = 1)
####Ordination plots
otu_table(dna.t)
### export log10 normalized data
dna=read.table("./Input_files/MG_filtered_counts", header = TRUE, row.names = 1)
rna=read.table("./Input_files/MT_filtered_counts", header = TRUE, row.names = 1)
met=read.table("./Input_files/redSea_virome_metadata", header = TRUE, row.names = 1, fill = TRUE)
# cretae phyloseq objects
otu.dna= otu_table(dna, taxa_are_rows=TRUE)
sam.dna= sample_data(met)
phy.dna= phyloseq(otu.dna, sam.dna)
otu.rna= otu_table(rna, taxa_are_rows=TRUE)
sam.rna= sample_data(met)
phy.rna= phyloseq(otu.rna, sam.rna)
####Transforming counts
dna.t=microbiome::transform(phy.dna, transform = "log10p", target = "OTU", shift = 0, scale = 1)
rna.t=microbiome::transform(phy.rna, transform = "log10p", target = "OTU", shift = 0, scale = 1)
log10.dna=otu_table(dna.t)
log10.rna=otu_table(rna.t)
write.table(log10.dna, "MG_log10_counts", quote =FALSE)
write.table(log10.dna, "MG_log10_counts", quote =FALSE)
write.table(log10.rna, "MT_log10_counts", quote =FALSE)
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= vegdist(t(dna), method  = "bray")
dna.dist
rna.dist= vegdist(t(rna), method  = "bray")
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist=vegdist(t(rna), method  = "bray")
install.packages("harrietr")
library(harrietr)
melt_dist(dna.dist, order = NULL, dist_name = "MG")
library(harrietr)
install.packages("ggtree")
BiocManager::install("ggtree")
library(ggtree)
melt_dist(dna.dist, order = NULL, dist_name = "MG")
library(harrietr)
melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.dist=
dna.dist
melt_dist(dna.dist, order = NULL, dist_name = "MG")
?vegdist
rna.dist=vegdist(t(rna), method  = "bray", diag=TRUE)
melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.dist= vegdist(t(dna), method  = "bray", diag=TRUE)
melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.dist
dna.dist= vegdist(t(dna), method  = "bray", diag=TRUE)
melt_dist(dna.dist, order = NULL, dist_name = "MG")
data.frame( t(combn(names(dna.dist),2)), dist=t(dna.dist)[lower.tri(dna.dist)] )
dist=t(dna.dist)[lower.tri(dna.dist)]
dist
subset(melt(dna.dist), value!=0)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
View(dna.dist)
melt_dist(dna.dist, order = NULL, dist_name = "MG")
melt_dist(rna.dist, order = NULL, dist_name = "MG")
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
melt_dist(dna.dist, order = NULL, dist_name = "MG")
View(dna.dist)
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
View(dna.pairs)
gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$iso1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$iso2=gsub("[0-9]", "", dna.pairs$iso2)
subset(dna.pairs, iso1 == iso2 )
dna.pairs.filt=subset(dna.pairs, iso1 == iso2 )
View(dna.pairs.filt)
boxplot(dna.pairs.filt$MG ~ dna.pairs.filt$MG)
ggplot(dna.pairs.filt,aes(x=iso1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
ggplot(dna.pairs.filt,aes(x=iso1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
ggplot(rna.pairs.filt,aes(x=iso1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
rna.pairs.filt=subset(rna.pairs, iso1 == iso2 )
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$iso1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$iso2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, iso1 == iso2 )
ggplot(rna.pairs.filt,aes(x=iso1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
grid.all=grid.arrange(a,b, ncol=1, nrow =2)
a=ggplot(dna.pairs.filt,aes(x=iso1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
b=ggplot(rna.pairs.filt,aes(x=iso1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
grid.all=grid.arrange(a,b, ncol=1, nrow =2)
dna.pairs.filt=unique(subset(dna.pairs, iso1 == iso2 ))
View(dna.pairs.filt)
grid.all=grid.arrange(a,b, ncol=1, nrow =1)
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.pairs$iso1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$iso2=gsub("[0-9]", "", dna.pairs$iso2)
dna.pairs.filt=unique(subset(dna.pairs, iso1 == iso2 ))
a=ggplot(dna.pairs.filt,aes(x=iso1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$iso1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$iso2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, iso1 == iso2 )
b=ggplot(rna.pairs.filt,aes(x=iso1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
grid.all=grid.arrange(a,b, ncol=1, nrow =2)
grid.all=grid.arrange(a,b, ncol=2, nrow =1)
b=ggplot(rna.pairs.filt,aes(x=iso1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 12)
grid.all=grid.arrange(a,b, ncol=2, nrow =1)
dev.off()
pdf("./outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 12)
grid.all=grid.arrange(a,b, ncol=2, nrow =1)
dev.off()
pdf("./outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 5, pointsize = 12)
grid.all=grid.arrange(a,b, ncol=2, nrow =1)
dev.off()
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
View(dna.pairs)
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.pairs$iso1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$iso2=gsub("[0-9]", "", dna.pairs$iso2)
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
View(dna.pairs)
dna.pairs$iso1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$iso2=gsub("[0-9]", "", dna.pairs$iso2)
dna.pairs.filt=unique(subset(dna.pairs, iso1 == iso2 ))
View(dna.pairs.filt)
View(dna.pairs)
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
pdf("./outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 4, pointsize = 12)
grid.all=grid.arrange(a,b, ncol=2, nrow =1)
dev.off()
pdf("./outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 3, pointsize = 12)
grid.all=grid.arrange(a,b, ncol=2, nrow =1)
dev.off()
##intraspecific variation
met=read.table("./redSea_virome_metadata", header = TRUE, row.names = 1, fill = TRUE)
setwd("~/Documents/GitHub/Red_Sea_virome/Input_files/")
##intraspecific variation
met=read.table("./redSea_virome_metadata", header = TRUE, row.names = 1, fill = TRUE)
View(dna.pairs.filt)
View(dna.dist)
View(dna.pairs)
View(dna.pairs)
View(dna.pairs.filt)
View(dna.pairs)
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna=read.table("../outputs/MG_log10_counts", header = TRUE)
setwd("~/Documents/GitHub/Red_Sea_virome/Input_files/")
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$sample=rna.pairs$iso1
rna.pairs$iso1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$iso2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, iso1 == iso2 )
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$sample1=rna.pairs$iso1
rna.pairs$sample2=rna.pairs$iso2
rna.pairs$iso1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$iso2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, iso1 == iso2 )
View(met)
rna.pairs.filt$clade=met$Minor_Clade[mach(rna.pairs.filt$sample1, rownames(met))]
rna.pairs.filt$clade=met$Minor_Clade[match(rna.pairs.filt$sample1, rownames(met))]
View(dna.pairs.filt)
View(rna.pairs.filt)
dna=read.table("../outputs/MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.pairs$iso1=gsub("[0-9]", "", dna.pairs$pair1)
dna.pairs$iso2=gsub("[0-9]", "", dna.pairs$pair2)
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.pairs$iso1=gsub("[0-9]", "", dna.pairs$pair1)
dna.pairs$iso2=gsub("[0-9]", "", dna.pairs$pair2)
dna.pairs$oair1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$pair2=gsub("[0-9]", "", dna.pairs$iso2)
dna.pairs.filt=unique(subset(dna.pairs, pair1 == pair2 ))
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.pairs$pair1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$pair2=gsub("[0-9]", "", dna.pairs$iso2)
dna.pairs.filt=unique(subset(dna.pairs, pair1 == pair2 ))
a=ggplot(dna.pairs.filt,aes(x=iso1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$pair1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$pair2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, pair1 == pair2 )
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
dna.pairs.filt$clade1=met$Minor_Clade[match(dna.pairs.filt$iso1, rownames(met))]
dna.pairs.filt$clade2=met$Minor_Clade[match(dna.pairs.filt$iso2, rownames(met))]
View(dna.pairs.filt)
View(dna.pairs.filt)
a=ggplot(dna.pairs.filt,aes(x=pair1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
c=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=0,hjust=0))
dev.off()
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=0,hjust=0))
pdf("./outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 3, pointsize = 12)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=0,hjust=0))
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 3, pointsize = 12)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=0,hjust=0))
dev.off()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=0,hjust=0))
dev.off()
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=2,hjust=0))
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=2,hjust=0))
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=2,hjust=0))
dev.off()
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=10,hjust=0))
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=10,hjust=0))
dev.off()
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=2,hjust=0), bottom = grid::textGrob("A",x=2,hjust=0))
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=2,hjust=0), bottom = grid::textGrob("A",x=2,hjust=0))
dev.off()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0), bottom = grid::textGrob("A",x=1,hjust=0))
dev.off()
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.pairs$pair1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$pair2=gsub("[0-9]", "", dna.pairs$iso2)
dna.pairs.filt=unique(subset(dna.pairs, pair1 == pair2 ))
dna.pairs.filt$clade1=met$Life_history_strategy[match(dna.pairs.filt$iso1, rownames(met))]
dna.pairs.filt$clade2=met$Life_history_strategy[match(dna.pairs.filt$iso2, rownames(met))]
a=ggplot(dna.pairs.filt,aes(x=pair1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
c=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$pair1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$pair2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, pair1 == pair2 )
rna.pairs.filt$clade1=met$Life_history_strategy[match(rna.pairs.filt$iso1, rownames(met))]
rna.pairs.filt$clade2=met$Life_history_strategy[match(rna.pairs.filt$iso2, rownames(met))]
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
c=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 0.5)#+ scale_fill_manual(values=COLrna) + coord_flip()
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$pair1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$pair2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, pair1 == pair2 )
rna.pairs.filt$clade1=met$Life_history_strategy[match(rna.pairs.filt$iso1, rownames(met))]
rna.pairs.filt$clade2=met$Life_history_strategy[match(rna.pairs.filt$iso2, rownames(met))]
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") #+ scale_fill_manual(values=COLrna) + coord_flip()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
dna=read.table("MG_log10_counts", header = TRUE)
dna.dist= as.matrix(vegdist(t(dna), method  = "bray", diag=TRUE))
dna.pairs=melt_dist(dna.dist, order = NULL, dist_name = "MG")
dna.pairs$pair1=gsub("[0-9]", "", dna.pairs$iso1)
dna.pairs$pair2=gsub("[0-9]", "", dna.pairs$iso2)
dna.pairs.filt=unique(subset(dna.pairs, pair1 == pair2 ))
dna.pairs.filt$clade1=met$Life_history_strategy[match(dna.pairs.filt$iso1, rownames(met))]
dna.pairs.filt$clade2=met$Life_history_strategy[match(dna.pairs.filt$iso2, rownames(met))]
a=ggplot(dna.pairs.filt,aes(x=pair1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 1)#+ scale_fill_manual(values=COLrna) + coord_flip()
c=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 1)#+ scale_fill_manual(values=COLrna) + coord_flip()
rna=read.table("MT_log10_counts", header = TRUE)
rna.dist= as.matrix(vegdist(t(rna), method  = "bray", diag=TRUE))
rna.pairs=melt_dist(rna.dist, order = NULL, dist_name = "MT")
rna.pairs$pair1=gsub("[0-9]", "", rna.pairs$iso1)
rna.pairs$pair2=gsub("[0-9]", "", rna.pairs$iso2)
rna.pairs.filt=subset(rna.pairs, pair1 == pair2 )
rna.pairs.filt$clade1=met$Life_history_strategy[match(rna.pairs.filt$iso1, rownames(met))]
rna.pairs.filt$clade2=met$Life_history_strategy[match(rna.pairs.filt$iso2, rownames(met))]
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0, 1) #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0, 1) #+ scale_fill_manual(values=COLrna) + coord_flip()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
a=ggplot(dna.pairs.filt,aes(x=pair1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 0.8)#+ scale_fill_manual(values=COLrna) + coord_flip()
c=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 0.8)#+ scale_fill_manual(values=COLrna) + coord_flip()
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0, 0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0,0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", main="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0, 0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", x="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0,0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
a=ggplot(dna.pairs.filt,aes(x=pair1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", title="Metagenomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 0.8)#+ scale_fill_manual(values=COLrna) + coord_flip()
c=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", title="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 0.8)#+ scale_fill_manual(values=COLrna) + coord_flip()
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", title="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0, 0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0,0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
a=ggplot(dna.pairs.filt,aes(x=pair1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", title="Metagenomes" ,x="") + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 0.8)#+ scale_fill_manual(values=COLrna) + coord_flip()
c=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "Bray-Curtis dissimilarities", title="" , x="") + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("") +  ylim(0, 0.8)#+ scale_fill_manual(values=COLrna) + coord_flip()
b=ggplot(rna.pairs.filt,aes(x=pair1, y=MT)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="", title="Metatranscriptomes" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0, 0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
d=ggplot(dna.pairs.filt,aes(x=clade1, y=MG)) +  geom_boxplot() + geom_jitter(width=0.25, alpha=0.5) + labs( y= "", x="" ) + theme(legend.title = element_blank(), axis.text.x = element_text(angle = 90, hjust = 1), panel.grid.major = element_line(colour = "transparent"), panel.grid.minor = element_line(colour = "transparent"), panel.background = element_blank(), axis.line = element_line(colour = "black"),  legend.position="none") + ggtitle("")+  ylim(0,0.8) #+ scale_fill_manual(values=COLrna) + coord_flip()
pdf("../outputs/RedSeaVirome_brayDissimilarities.pdf",  width = 7, height = 7, pointsize = 10)
grid.all=grid.arrange(a,b,c,d, ncol=2, nrow =2, top = grid::textGrob("A",x=1,hjust=0))
dev.off()
library(vegan)
# species matrix
spdf <- matrix(NA, 60, 4, dimnames =
list(1:60, c("sp1", "sp2", "sp3", "sp4")))
spdf <- as.data.frame(spdf)
# 1st factor = treatment:
treat <- gl(3, 20, labels = paste("t", 1:3, sep=""))
# 2nd factor = impact:
imp <- rep(gl(2, 10, labels = c("yes", "no")), 3)
View(spdf)
# simulating effect -
# simulation will add similar effects
# and no interactions (see plot):
eff <- sort(rep(1:6, 10))
# add noise:
spdf$sp1 = eff + rnorm(60, 0, 0.25)
spdf$sp2 = eff + rnorm(60, 0, 0.25)
spdf$sp3 = eff + rnorm(60, 0, 0.25)
spdf$sp4 = eff + rnorm(60, 0, 0.25)
View(spdf)
imp
treat
# interaction plot for all species:
par(mfrow=c(2, 2), mar = c(2.5, 2.5, 0.5, 0.5))
for (i in 1:4) {interaction.plot(treat, imp, spdf[, i], lty = c(1, 2), legend = F);
legend("topleft", bty = "n", cex = 1.2,
paste("Species", i, sep = " "));
legend("bottomright", c("no", "yes"),
bty = "n", lty = c(2, 1))}
